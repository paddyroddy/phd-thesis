\chapter{Slepian Scale-Discretised Wavelets on Manifolds}\label{sec:chapter4}

\section{Introduction}

\section{Mathematical Background and Problem Formulation}

\subsection{Mathematical Preliminaries}

\subsubsection{Riemannian Manifolds}

Let \(\manifold{}\) denote a compact, smooth, connected \(d\)-dimensional Riemannian manifold without boundary contained in \(\mathbb{R}^{n}\).
The Hilbert space \(\hilbert{\manifold}\) is formed by the set of functions \(f : \manifold \to \mathbb{R}\) that are square-integrable with respect to the Riemannian volume \(\meshVolume{}\).
The geodesic distance between two points is denoted \(r(x,y)\), and the Laplace-Beltrami operator on \(\manifold{}\) is denoted \(\laplacian{}\).
Let the set of all isometries between two manifolds \(\manifold{}\) and \(\manifold'\) be denoted \(\isom{\manifold,\manifold'}\), and set \(\isom{\manifold} = \isom{\manifold,\manifold}\) to be the isometry group of \(\manifold{}\).
Similarly, \(\diff{\manifold} = \diff{\manifold,\manifold}\) is set to be the diffeomorphism group on \(\manifold{}\).

In practice, one must discretise the manifolds and represent them as graphs.
A review of graphs is presented in \cref{sec:chapter4_graphs}.

\subsubsection{Graphs}\label{sec:chapter4_graphs}

\subsubsection{Polygonal Meshes}

\input{figures/chapter4/eigenhomers}

\subsection{Slepian Scale-Discretised Wavelets on the Sphere}\label{sec:chapter4_slepian_scale_discretised_wavelets_sphere}

\subsection{Problem Formulation}

This work generalises Slepian scale-discretised wavelets on the sphere, defined in \cref{sec:chapter4_slepian_scale_discretised_wavelets_sphere}, to arbitrary manifolds.

\section{Working with Manifolds}

In this section a review of the Slepian spatial-spectral concentration problem is presented in \cref{sec:chapter4_slepian_concentration_problem_manifolds}.
A review of the sifting convolution follows in \cref{sec:chapter4_sifting_convolution_manifolds} which allows one to perform convolutions on manifolds.

\subsection{Slepian Concentration Problem on Manifolds}\label{sec:chapter4_slepian_concentration_problem_manifolds}

The problem of spatial concentration of bandlimited signals (likewise spectral concentration of spacelimited signals) was first studied by Slepian, Landau and Pollak in the 1960s~\cite{Slepian1961,Landau1961,Landau1962}.
Initially for time domain signals, it has since been extended to other domains such as signals on the sphere~\cite{Simons2006,Roddy2021a,Xu1983,Wieczorek2005}.
This work considers optimally concentrated functions within a region \(R\) of a manifold \(\manifold{}\), an example of which is shown in \cref{fig:chapter4_region}.

\input{figures/chapter4/example_region_manifold}

\subsubsection{Spatial Concentration of a Bandlimited Function}

To maximise the spatial energy concentration of a bandlimited signal \(f \in \hilbert{\manifold}\), the following ratio must be maximised:
%
\begin{equation}
	\mu
	%
	= \frac{\integrateRegion{\meshVolume} \abs{\mesh{f}}^{2}}{\integrateManifold{x} \abs{\mesh{f}}^{2}},
\end{equation}
%
where spatial concentration is measured by \(0 < \mu < 1\).
In harmonic space this can be simplified to a sum
%
\begin{equation}\label{eq:chapter4_spatial_concentration_ratio}
	\mu
	%
	= \frac{\sum\limits_{i} f_{i} \sum\limits_{j} D_{i,j} f_{j}}{\meshSum \abs{f_{i}}^{2}},
\end{equation}
%
where
%
\begin{equation}
	D_{i,j}
	%
	= \integrateRegion{\meshVolume \mesh{\phi_{i}} \mesh{\phi_{j}}}
\end{equation}
%
is a square matrix including all basis functions of the manifold.
Rewriting \cref{eq:chapter4_spatial_concentration_ratio} as a matrix variational problem
%
\begin{equation}
	\mu
	%
	= \frac{\transpose{\vb{f}} \vb{D} \vb{f}}{\transpose{\vb{f}} \vb{f}},
\end{equation}
%
where \(\vb{f}\) are the harmonic coefficients of \(\mesh{f}\), and are the solutions to the eigenproblem
%
\begin{equation}\label{eq:chapter4_eigenproblem}
	\vb{D}\vb{f}
	%
	= \mu \vb{f}.
\end{equation}
%
The eigenvalues \(\mu_{i}\) act as a measure of the relative spatial concentration
%
\begin{equation}
	1 > \mu_{1} \geq \mu_{2} \geq \ldots \geq \mu_{\imax} > 0, % chktex 11
\end{equation}
%
of the corresponding eigenvectors
%
\begin{equation}
	\vb{f}_{1},\ \vb{f}_{2},\ \ldots,\ \vb{f}_{\imax}.
\end{equation}
%
No bandlimited function can be restricted exactly within a region \(R\) and hence \(\mu_{1}<1\).
Due to the positive definiteness of \(\vb{D}\) the smallest eigenvalue \(\mu_{\imax}\) is strictly greater than zero.
A manifold analogue of the \emph{Shannon number} can be constructed by
%
\begin{equation}\label{eq:chapter4_shannon}
	N
	%
	= \frac{A_{R}}{A_{\manifold}} \imax,
\end{equation}
%
where \(A\) denotes the area of the region \(R\)/manifold \(\manifold{}\).
The Shannon number is a good estimate of the number of significant eigenvalues~\cite{Percival1993}.

\subsubsection{Slepian Decomposition}

The Slepian functions provide an alternative orthogonal basis of the manifold, decomposing a function \(f \in \hilbert{\manifold}\) into this basis
%
\begin{equation}
	\mesh{f}
	%
	= \sum\limits_{p=1}^{\imax} \slepian{f} \mesh{\slepian{S}},
\end{equation}
%
where the sum is over all basis functions of the manifold.
For a well-localised function in the region \(R\) (\ie{} \(f \in \hilbert{R}\)) the sum may be truncated at the Shannon number
%
\begin{equation}
	\mesh{f}
	%
	\approx \sum\limits_{p=1}^{N} \slepian{f} \mesh{\slepian{S}}
	%
	= \slepianSum \slepian{f} \mesh{\slepian{S}},
\end{equation}
%
where the last line introduces a shorthand notation.
The Slepian coefficients \(\slepian{f}\) are calculated through the usual projection on to the basis functions
%
\begin{equation}
	\slepian{f}
	%
	= \braket{f}{\slepian{S}}.
\end{equation}

The Slepian coefficients of a well-localised function may be computed with an integral over the region \(R\) rather than an integral over the whole manifold \(\manifold{}\):
%
\begin{equation}
	\slepian{f}
	%
	= \frac{1}{\slepian{\mu}} \integrateRegion{\meshVolume} \mesh{f} \mesh{\slepian{S}},
\end{equation}
%
as
%
\begin{align}
	\integrateRegion{\meshVolume} \mesh{f} \mesh{\slepian{S}}
	%
	 & = \slepianSum['] \slepian[']{f} \integrateRegion{\meshVolume} \mesh{\slepian[']{S}} \mesh{\slepian{S}} \nonumber \\
	%
	 & = \slepianSum['] \slepian[']{f} \transpose{\slepian{\vb{S}}} \vb{D} \slepian[']{\vb{S}} \nonumber                \\
	%
	 & = \slepian{f} \slepian{\mu},
\end{align}
%
where \(\vb{S}\) are the harmonic coefficients of \(\mesh{\slepian{S}}\).
Note the use of the orthogonality results
%
\begin{equation}\label{eq:chapter4_orthogonality_manifold}
	\integrateManifold{x} \mesh{\slepian{S}} \mesh{\slepian[']{S}}
	%
	= \transpose{\slepian[']{\vb{S}}} \slepian{\vb{S}}
	%
	= \delta_{pp'},
\end{equation}
%
and
%
\begin{equation}
	\integrateRegion{\meshVolume} \mesh{\slepian{S}} \mesh{\slepian[']{S}}
	%
	= \transpose{\slepian[']{\vb{S}}} \vb{D} \slepian{\vb{S}}
	%
	= \slepian{\mu} \transpose{\slepian[']{\vb{S}}} \slepian{\vb{S}}
	%
	= \slepian{\mu} \delta_{pp'}.
\end{equation}

To transform from Slepian coefficients to the basis functions of the manifold
%
\begin{equation}\label{eq:chapter4_slepian_to_harmonic}
	f_{i}
	%
	= \integrateManifold{x} \mesh{f} \mesh{\phi_{i}}
	%
	= \slepianSum \slepian{f} {(\slepian{S})}_{i},
\end{equation}
%
where \({(\slepian{S})}_{i}\) are the eigenvectors of the eigenproblem \cref{eq:chapter4_eigenproblem}:
%
\begin{equation}
	{(\slepian{S})}_{i}
	%
	= \integrateManifold{x} \mesh{\slepian{S}} \mesh{\phi_{i}}.
\end{equation}
%
The inverse operation of \cref{eq:chapter4_slepian_to_harmonic} is
%
\begin{equation}\label{eq:chapter4_harmonic_to_slepian}
	\slepian{f}
	%
	= \integrateManifold{x} \mesh{f} \mesh{\slepian{S}}
	%
	= \sum\limits_{i} f_{i} {(\slepian{S})}_{i}.
\end{equation}

\subsection{Sifting Convolution on Manifolds}\label{sec:chapter4_sifting_convolution_manifolds}

A central part of wavelet transforms is the convolution.
On \(\mathbb{R}^{d}\), the convolution of a signal \(f \in \hilbert{\mathbb{R}^{d}}\) with a filter \(g \in \hilbert{\mathbb{R}^{d}}\) is defined by translating \(g\) against \(f\); however, general manifolds do not have well-defined translations.
Recently developed by the authors of this work, the sifting convolution~\cite{Roddy2021} is built on a translation which simply involves a product of the basis functions.
Initially defined in the spherical setting, the sifting convolution can be arbitrarily extended to other domains.

The translation operator on the manifold is
%
\begin{equation}
	\mesh{(\translation{y}\phi_{i})}
	%
	\equiv \meshY{\phi_{i}} \mesh{\phi_{i}},
\end{equation}
%
where \(y\) is a point on the manifold.
An arbitrary function \(f \in \hilbert{\manifold}\) is translated thus
%
\begin{equation}
	\mesh{(\translation{y}f)}
	%
	= \sum\limits_{i} f_{i} \meshY{\phi_{i}} \mesh{\phi_{i}},
\end{equation}
%
implying
%
\begin{equation}
	{(\translation{y}f)}_{i}
	%
	= f_{i} \meshY{\phi_{i}}.
\end{equation}
%
The sifting convolution on the manifold of \(f,\ g \in \hilbert{\manifold}\) follows by the inner product
%
\begin{equation}
	\mesh{\convolution{f}{g}}
	%
	\equiv \integrateManifold{y} \meshY{(\translation{x}f)} \meshY{g},
\end{equation}
%
which is a product in harmonic space
%
\begin{equation}
	{\convolution{f}{g}}_{i}
	%
	= f_{i} g_{i}.
\end{equation}
%
This convolution can be used to define wavelets restricted to a region of the manifold using the basis functions introduced in \cref{sec:chapter4_slepian_concentration_problem_manifolds} in the translation.

\section{Slepian Wavelets on Manifolds}

\subsection{Slepian Sifting Convolution}

To construct wavelets in a region of the manifold a suitable convolution is required.
The sifting convolution on the manifold defined in \cref{sec:chapter4_slepian_concentration_problem_manifolds} and developed by the authors of the current article~\cite{Roddy2021}, can be extended to work with the Slepian functions as a basis.

Consider the sifting convolution of a region on a manifold with the Slepian functions as a localised basis.
The translation is defined as such
%
\begin{equation}
	\mesh{(\translation{y}\slepian{S})}
	%
	\equiv \meshY{\slepian{S}} \mesh{\slepian{S}},
\end{equation}
%
where \(y\) is a point on the manifold and \(\mesh{\slepian{S}}\) are the Slepian functions defined in \cref{sec:chapter4_slepian_concentration_problem_manifolds}.
Hence, the translation of an arbitrary function \(f \in \hilbert{R}\) is
%
\begin{equation}
	\mesh{(\translation{y}f)}
	%
	= \slepianSum \slepian{f} \meshY{\slepian{S}} \mesh{\slepian{S}},
\end{equation}
%
which is the following in Slepian space
%
\begin{equation}
	\slepian{(\translation{y}f)}
	%
	= \slepian{f} \mesh{\slepian{S}}.
\end{equation}
%
As before, the sifting convolution between two functions \(f,\ g \in \hilbert{R}\) is
%
\begin{equation}
	\mesh{\convolution{f}{g}}
	%
	\equiv \integrateManifold{y} \meshY{(\translation{x}f)} \meshY{g},
\end{equation}
%
which becomes a product in Slepian space
%
\begin{equation}
	\slepian{\convolution{f}{g}}
	%
	= \slepian{f} \slepian{g},
\end{equation}
%
and hence is efficient to compute.
Slepian wavelets may now be defined utilising this convolution in Slepian space.

\subsection{Slepian Scale-Discretised Wavelets}\label{sec:chapter4_slepian_scale_discretised_wavelets}

A Slepian wavelet transform can be constructed through a tiling of Slepian space, where \(p\) is restricted to \(N=\imax A_{R}/A_{\manifold}\) (or \(\imax{}\) for whole manifold).
Spatially localised, scale-dependent content of a signal may be probed through a scale-discretised wavelet transform.
The construction of these wavelets is in an analogous manner to~\cite{Wiaux2008,McEwen2018} but are computed in the Slepian basis rather than the basis functions of the sphere (\cf{} manifold).

For a signal of interest \(f \in \hilbert{R}\) concentrated within a region \(R\), the wavelet coefficients \(W^{\Psi^{j}} \in \hilbert{R}\) are defined through a sifting convolution of \(f\) with the wavelet \(\Psi^{j} \in \hilbert{R}\) for wavelet scale \(j\):
%
\begin{align}
	\mesh{W^{\Psi^{j}}}
	%
	 & = \mesh{\convolution{\Psi^{j}}{f}} \nonumber                         \\
	%
	 & = \integrateManifold{y} \meshY{(\translation{x}\Psi^{j})} \meshY{f}.
\end{align}
%
In Slepian space this becomes
%
\begin{equation}\label{eq:chapter4_slepian_wavelet_p}
	\slepian{W}^{\Psi^{j}}
	%
	= \slepian{\Psi}^{j} \slepian{f},
\end{equation}
%
where \(\slepian{\Psi}^{j}\) are the Slepian harmonic coefficients of the wavelet at scale \(j\).

Wavelets are typically paired with a scaling function, each capturing different underlying scales of the signal.
Scaling coefficients \(W^{\Phi} \in \hilbert{R}\) may be similarly defined by a sifting convolution between \(f\) and the scaling function \(\Phi \in \hilbert{R}\):
%
\begin{align}
	\mesh{W^{\Phi}}
	%
	 & = \mesh{\convolution{\Phi}{f}} \nonumber                         \\
	%
	 & = \integrateManifold{y} \meshY{(\translation{x}\Phi)} \meshY{f},
\end{align}
%
or in Slepian space
%
\begin{equation}\label{eq:chapter4_slepian_scaling_p}
	\slepian{W}^{\Phi}
	%
	= \slepian{\Phi} \slepian{f},
\end{equation}
%
where \(\slepian{\Phi}\) are the Slepian coefficients of the scaling function.

Supposing that the wavelets and scaling function satisfy an admissibility condition, a function \(f\) may be reconstructed from its wavelet and scaling coefficients by
%
\begin{equation}\label{eq:chapter4_synthesis}
	\mesh{f}
	%
	= \integrateManifold{y} \bigg(
	%
	\meshY{(\translation{x}\Phi)} \meshY{W^{\Phi}}
	%
	+ \waveletSum \meshY{(\translation{x}\Psi^{j})} \meshY{W^{\Psi^{j}}}
	%
	\bigg),
\end{equation}
%
or in Slepian space
%
\begin{equation}
	\slepian{f}
	%
	= \slepian{W}^{\Phi} \slepian{\Phi}
	%
	+ \waveletSum \slepian{W}^{\Psi^{j}} \slepian{\Psi}^{j}.
\end{equation}
%
The parameters \(J_{0}\) and \(J\) represent the lowest and highest scales \(j\) of the wavelet decomposition respectively --- to ensure exact reconstruction these parameters must be set consistently.
The admissibility condition required for synthesis \cref{eq:chapter4_synthesis} to hold is thus
%
\begin{equation}\label{eq:chapter4_admissibility}
	\abs{\slepian{\Phi}}^{2}
	%
	+ \waveletSum \abs{\slepian{\Psi}^{j}}^{2}
	%
	= 1,\ \forall p.
\end{equation}
%
Wavelets and a scaling function that satisfy this admissibility condition may now be defined.

\subsection{Generating Functions}\label{sec:chapter4_generating_functions}

Consider the smooth generating functions defined by~\cite{Wiaux2008} to tile the Slepian line.
Consider the \(C^{\infty}\) Schwartz function with compact support on \(\interval{-1}{1}\):
%
\begin{equation}
	s(t) \equiv
	%
	\begin{cases}
		\exp(1/(t^{2}-1)), & t \in \interval{-1}{1}    \\
		%
		0,                 & t \notin \interval{-1}{1}
	\end{cases}
\end{equation}
%
for \(t \in \mathbb{R}\).
The positive real parameter \(\lambda \in \realPosParam{}\) may then be introduced to map \(s(t)\) to
%
\begin{equation}
	s_{\lambda}(t)
	%
	\equiv s\bigg(\frac{2\lambda}{\lambda-1}(t-\lambda^{-1}) - 1\bigg),
\end{equation}
%
which has compact support in \(\interval{1/\lambda}{1}\).
One can define the smoothly decreasing function \(k_{\lambda}\) by
%
\begin{equation}
	k_{\lambda}(t)
	%
	\equiv \frac{\int_{t}^{1} \dd{t'} s^{2}_{\lambda}(t')/t'}
	%
	{\int_{1/\lambda}^{1} \dd{t'} s^{2}_{\lambda}(t')/t'},
\end{equation}
%
which is unity for \(t < 1/\lambda{}\), zero for \(t > 1\), and smoothly decreasing from unity to zero for \(t \in \interval{1/\lambda}{1}\).
The wavelet generating function is defined as
%
\begin{equation}
	\kappa_{\lambda}(t)
	%
	\equiv \sqrt{k_{\lambda}(t/\lambda) - k_{\lambda}(t)},
\end{equation}
%
and the scaling function generating function is
%
\begin{equation}
	\eta_{\lambda}(t)
	%
	\equiv \sqrt{k_{\lambda}(t)}.
\end{equation}

An instinctive approach is to define the wavelets \(\slepian{\Psi}^{j}\) from the generating functions \(\kappa_{\lambda}\) to have support on \(\interval{\lambda^{j-1}}{\lambda^{j+1}}\), yielding
%
\begin{equation}
	\slepian{\Psi}^{j}
	%
	\equiv \kappa_{\lambda}\bigg(\frac{p}{\lambda^{j}}\bigg).
\end{equation}
%
For \(p \geq \lambda^{J_{0}}\) the admissibility condition \cref{eq:chapter4_admissibility} is satisfied for these wavelets, where \(J_{0}\) is the lowest wavelet scale used in the decomposition.
Modes that cannot be probed by wavelets can be extracted through the construction of a scaling function \(\Phi{}\) (\ie{} modes with \(p < \lambda^{J_{0}}\)):
%
\begin{equation}
	\slepian{\Phi}
	%
	\equiv \eta_{\lambda}\bigg(\frac{p}{\lambda^{J_{0}}}\bigg).
\end{equation}
%
Exact reconstruction can be achieved by setting \(J\) appropriately
%
\begin{equation}
	J = \lceil{} \log_{\lambda}(N)\rceil{}.
\end{equation}
%
Assuming that \(0 \leq J_{0} < J\) is satisfied, the lowest wavelet scale \(J_{0}\) is arbitrary.
The Slepian wavelets are constructed by the tiling of the Slepian line as shown in \cref{fig:chapter4_tiling}.

\input{figures/chapter4/homer_tiling}

\subsection{Properties}

The properties of Slepian wavelets on manifolds are reviewed here.
In comparison to standard scale-discretised wavelets, the properties are often similar, but not always.

\subsubsection{Localisation}\label{sec:chapter4_localisation}

A tiling of the harmonic line leads to the usual construction of scale-discretised wavelets.
Hence, the value of \(j\) in the wavelets \(\Psi^{j}\) corresponds to increasingly smaller scales (higher frequencies).
However, in the Slepian setting \(p\) is a measure of spatial concentration, where a lower \(p\) corresponds to better localisation of the Slepian function.
As Slepian wavelets are built on a tiling of the Slepian harmonic line, the localisation is captured in the wavelets and wavelet coefficients.

\subsubsection{Wavelet Energy}

The wavelet energy is
%
\begin{equation}
	\norm{\Psi^{j}}^{2}
	%
	= \integrateManifold{x} \abs{\mesh{\Psi^{j}}}^{2}
	%
	= \slepianSum \abs{\slepian{\Psi}^{j}}^{2}.
\end{equation}
%
Similarly, the scaling function energy is
%
\begin{equation}
	\norm{\Phi}^{2}
	%
	= \slepianSum \abs{\slepian{\Phi}}^{2}.
\end{equation}

\subsubsection{Parseval Frame}

A \emph{Parseval frame} is satisfied by Slepian scale-discretised wavelets on manifolds
%
\begin{equation}
	A\norm{f}^{2} \leq \integrateManifold{x} \bigg(
	%
	\abs{\braket{\translation{x}\Phi}{f}}^{2}
	%
	+ \waveletSum \abs{\braket{\translation{x}\Psi^{j}}{f}}^{2}
	%
	\bigg) \leq B\norm{f}^{2},
\end{equation}
%
where \(A,\ B \in \realPosParam{}\).
Proving this requires the definition in Slepian space of the scaling coefficients \cref{eq:chapter4_slepian_scaling_p} and the wavelet coefficients \cref{eq:chapter4_slepian_wavelet_p}, along with the orthogonality of the Slepian functions \cref{eq:chapter4_orthogonality_manifold}
%
\begin{equation}
	\slepianSum \abs{\slepian{\Phi}}^{2} \abs{\slepian{f}}^{2}
	%
	+ \waveletSum \abs{\slepian{\Psi}^{j}}^{2} \abs{\slepian{f}}^{2}
	%
	= \norm{f}^{2},
\end{equation}
%
where the admissibility condition \cref{eq:chapter4_admissibility} results in the final equality.
Therefore, a Parseval frame holds for scale-discretised wavelets with \(A = B = 1\), which implies that the energy of \(f\) is conserved in wavelet space.

\subsubsection{Wavelet Domain Variance}

For notational brevity define a quantity
%
\begin{equation}
	\varphi \in \set{\Phi,\Psi^{j}}
\end{equation}
%
to represent both the scaling function and the wavelets.
The variance of the wavelet/scaling coefficients is given by
%
\begin{equation}
	\variance{\mesh{W^{\varphi}}}
	%
	= \expval{\abs{\mesh{W^{\varphi}}}^{2}}
	%
	-\abs{\expval{\mesh{W^{\varphi}}}}^{2},
\end{equation}
%
where the expected value of the wavelet/scaling coefficients is zero for the common case of zero-mean Gaussian noise.
Thus, the variance can be expanded to become
%
\begin{equation}\label{eq:chapter4_slepian_isotropic_noise}
	\variance{\mesh{W^{\varphi}}}
	%
	= \slepianSum \slepianSum['] \slepian{\varphi} \slepian[']{\varphi} \mesh{\slepian{S}} \mesh{\slepian[']{S}} \expval{\slepian{f} \slepian[']{f}}.
\end{equation}

Consider homogenous and isotropic noise defined by its power spectrum
%
\begin{equation}
	\expval{f_{i} f_{j}}
	%
	= C_{i} \delta_{i j},
\end{equation}
%
where \(C_{i} = \sigma^{2}\) for white noise.
The power expression in Slepian space can be found by
%
\begin{align}
	\expval{\slepian{f} \slepian[']{f}}
	%
	 & = \sum\limits_{i} \sum\limits_{j} \expval{f_{i} f_{j}} \empty{} {(\slepian{S})}_{i} {(\slepian[']{S})}_{j} \nonumber \\
	%
	 & = \sigma^{2} \delta_{pp'},
\end{align}
%
where the first line follows from \cref{eq:chapter4_harmonic_to_slepian}, and the last line follows from the orthogonality of the Slepian functions \cref{eq:chapter4_orthogonality_manifold}.
Hence, the final expression for the wavelet domain variance is
%
\begin{equation}
	\variance{\mesh{W^{\varphi}}}
	%
	= \sigma^{2} \slepianSum \abs{\slepian{\varphi}}^{2} \abs{\mesh{\slepian{S}}}^{2},
\end{equation}
%
and as such the variance depends on the position on the manifold.

\section{Numerical Illustration}

In this section the construction and application of Slepian wavelets for an example region on a mesh (\cf{} manifold) is demonstrated.
The Slepian functions and eigenvalues of a region of a Homer Simpson mesh are presented in \cref{sec:chapter4_homer_region}.
A field is constructed on the region of the mesh in \cref{sec:chapter4_wavelets_wavelet_coefficients}, and the resulting wavelets and wavelet coefficients are computed.
A possible use of Slepian wavelets is shown in \cref{sec:chapter4_wavelet_denoising} through a straightforward denoising procedure.
All computations are performed with the \texttt{S2LET}\footnote{\url{http://astro-informatics.github.io/s2let/}}~\cite{Leistedt2013} code, which enables the construction of the wavelet generating functions discussed in \cref{sec:chapter4_generating_functions}.

\subsection{Homer Region}\label{sec:chapter4_homer_region}

A region of a manifold is created on a mesh of Homer Simpson, \cref{fig:chapter4_homer_region} presents the masked region of Homer's head.
The Slepian functions of this region are computed by solving the eigenproblem \cref{eq:chapter4_eigenproblem}, and then performing an inverse harmonic transform.
The resulting Shannon number \cref{eq:chapter4_shannon} of the region \(R\) is \(N=329\).
A set of Slepian functions of the mesh are shown in \cref{fig:chapter4_slepian_functions} for \(p \in \set{1, 10, 25, 50, 100, 200}\).
Comparing panel (f) to panel (a) one can see that the latter Slepian functions are more spread out in the region, representing worse concentration.
The corresponding eigenvalues \(\slepian{\mu}\) are a measure of spatial concentration, which remain \(\almost{1}\) for many \(p\) values before rapidly decreasing towards zero around \(N\).
The first \(N\) eigenvalues of this Homer region are shown in \cref{fig:chapter4_slepian_eigenvalues}, were the plot to extend to all \(\imax{}\) Slepian eigenvalues then the rest of the eigenvalues would be \(\almost{0}\).

\input{figures/chapter4/homer_region}

\input{figures/chapter4/homer_slepian_functions}

\input{figures/chapter4/homer_slepian_eigenvalues}

\subsection{Wavelets and Wavelet Coefficients}\label{sec:chapter4_wavelets_wavelet_coefficients}

The Slepian scaling function and wavelets defined in \cref{sec:chapter4_slepian_scale_discretised_wavelets} are built on a tiling of the Slepian line with parameters \(\lambda=3\) and \(J_{0}=2\).
This tiling is shown in \cref{fig:chapter4_tiling} for \(\num{1275}\) basis functions of the Homer mesh, where the Shannon number \(N=329\) is highlighted.
Hence, for this region the scaling function and wavelets for scales \(j \in \set{2, 3, 4, 5, 6}\) are the only non-zero functions.
These wavelets are presented in \cref{fig:chapter4_wavelets}, which show a similar pattern to the Slepian functions where the scaling function is more concentrated in the region than the wavelet scale \(j=6\).
To perform a scale-discretised wavelet transform one requires a signal on the mesh.
\cref{fig:chapter4_homer_data} presents the such a signal, the \(z\)-component of the per vertex normals of the Homer mesh.
With some data to hand, the scaling and wavelet coefficients of the Homer head region are given in \cref{fig:chapter4_wavelet_coefficients}.

\input{figures/chapter4/homer_wavelets}

\input{figures/chapter4/homer_field}

\input{figures/chapter4/homer_wavelet_coefficients}

\subsection{Wavelet Denoising}\label{sec:chapter4_wavelet_denoising}

Wavelets are used in a variety of contexts in signal processing, one common use case is for denoising a signal.
Localised features in the data can be extracted to different wavelet scales, and hence the desired parts of the signal can be preserved whilst isolating the noise.
To showcase Slepian wavelets, white noise is added to the signal in the right panel of \cref{fig:chapter4_homer_data}.
A straightforward hard-thresholding denoising procedure follows.

Consider a signal localised in the region \(R\) in the presence of noise
%
\begin{equation}\label{eq:chapter4_noised_signal}
	\mesh{z}
	%
	= \mesh{s} + \mesh{n},
\end{equation}
%
where the signal and noise are represented by \(\mesh{s}\) and \(\mesh{n}\) respectively.
The power spectrum of noise in Slepian space is as before
%
\begin{equation}
	\expval{\slepian{n} \slepian[']{n}}
	%
	= \sigma^{2} \delta_{pp'}.
\end{equation}
%
To assess the recovery of the initial data, a signal-to-noise ratio for the region is defined
%
\begin{equation}
	\snr{z}
	%
	\equiv 10 \log_{10} \frac{\norm{s}^{2}}{\norm{z - s}^{2}}.
\end{equation}
%
A denoised version of \(z\) is desired, denoted by \(d \in \hilbert{R}\), with a large \(\snr{d}\) such that \(d\) extracts the informative signal \(s\).
Often the scaling coefficients are \emph{not} used in hard-thresholding; however, in the Slepian setting the scaling function and wavelets are treated equivalently.
The scaling function in the Slepian setting is not a low-frequency representation of the signal due to the localisation of the Slepian functions (see \cref{sec:chapter4_localisation}).

Since the wavelet transform is linear, the individual elements sum to give the wavelet/scaling coefficients of \cref{eq:chapter4_noised_signal}
%
\begin{equation}
	\mesh{Z^{\varphi}}
	%
	= \mesh{S^{\varphi}} + \mesh{N^{\varphi}},
\end{equation}
%
where the wavelet coefficients are denoted by capital letters, \ie{}
%
\begin{equation}
	\mesh{Z^{\varphi}} = \mesh{\convolution{\varphi}{z}}.
\end{equation}
%
In wavelet space the noise is
%
%
\begin{equation}
	\variance{\mesh{N^{\varphi}}}
	%
	= \sigma^{2} \slepianSum \abs{\slepian{\varphi}}^{2} \abs{\mesh{\slepian{S}}}^{2}
	%
	\equiv {\mesh{\sigma^{\varphi}}}^{2},
\end{equation}
%
where \(\sigma^{\varphi}\) represents the standard deviation of the noise in wavelet space.
To denoise the signal one may hard-threshold the scaling/wavelet coefficients with a threshold \(T\) proportional to the standard deviation of the noise.
Hence, the denoised wavelet coefficients \(\mesh{D^{\varphi}} = \mesh{\convolution{\varphi}{d}}\) are
%
\begin{equation}
	\mesh{D^{\varphi}} =
	%
	\begin{cases}
		0,
		%
		 & \mesh{Z^{\varphi}} < \mesh{T^{\varphi}},    \\
		%
		\mesh{Z^{\varphi}},
		%
		 & \mesh{X^{\varphi}} \geq \mesh{T^{\varphi}},
	\end{cases}
\end{equation}
%
where
%
\begin{equation}
	\mesh{T^{\varphi}}
	%
	= N_{\sigma}\mesh{\sigma^{\varphi}},
\end{equation}
%
with \(N_{\sigma} \in \realPosParam{}\).
Reconstruction of the signal \(d\) follows by an inverse wavelet transform with these thresholded wavelet coefficients.
This procedure merely demonstrates a practical use case of Slepian wavelets, more sophisticated denoising formalisms can be developed.

To perform the denoising, Gaussian white noise is added to the data in the right panel of \cref{fig:chapter4_homer_data}.
The noised signal is shown in panel (a) of \cref{fig:chapter4_denoising} with an initial signal-to-noise ratio of \(\SI{0.32}{\dB}\).
Panels (b-c) show the results of the denoising procedure describe previously for \(N_{\sigma} \in \set{1,2}\), with signal-to-noise ratios of \(\SI{2.29}{\dB}\) and \(\SI{0.98}{\dB}\) respectively.
At \(N_{\sigma}=1\) an initial boost in signal-to-noise ratio is observed; however, as more signal is removed the hard-thresholding scheme experiences diminishing returns.

\input{figures/chapter4/homer_denoising}

\input{figures/chapter4/other_mesh_regions}

\input{tables/chapter4/mesh_denoising}
